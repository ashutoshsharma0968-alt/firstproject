<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PINTU WOOD CRAFT - Attendance System</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    PINTU WOOD CRAFT<br>
    Worker Attendance System
</header>

<div class="container">
    <h3>Date: <span id="today"></span></h3>

    <label>Party Name</label>
    <select id="partySelect"></select>
    <input type="text" id="newParty" placeholder="Add New Party Name">
    <button class="btn-green" onclick="addParty()">Save Party</button>

    <label>Worker Name</label>
    <select id="workerSelect"></select>
    <input type="text" id="newWorker" placeholder="Add New Worker Name">

    <label>Category</label>
    <select id="categorySelect">
        <option>Mistri</option>
        <option>Helper</option>
    </select>
    <button class="btn-green" onclick="addWorker()">Save Worker</button>

    <label>Status</label>
    <select id="statusSelect">
        <option>Present</option>
        <option>Absent</option>
        <option>Half Day</option>
    </select>

    <button class="btn-blue" onclick="markAttendance()">Mark Attendance</button>
</div>

<div class="container">
    <h3>Attendance Records</h3>
    <table id="recordTable">
        <tr>
            <th>Date</th>
            <th>Party</th>
            <th>Worker</th>
            <th>Status</th>
            <th>Delete</th>
        </tr>
    </table>
</div>

<div class="container">
    <h3>Salary Calculator</h3>

    <label>Select Worker</label>
    <select id="salaryWorker"></select>

    <p><b>Days Worked: <span id="daysWorked">0</span></b></p>

    <label>Daily Wage (₹)</label>
    <input type="number" id="dailyWage">

    <button class="btn-dark" onclick="calculateSalary()">Calculate Salary</button>

    <h3 id="salaryOutput"></h3>
</div>

<footer>
    © 2025 PINTU WOOD CRAFT | All Rights Reserved
</footer>

<script>
// -------------------- DATE ----------------------
document.getElementById("today").innerText =
    new Date().toLocaleDateString("en-IN");

// -------------------- LOAD / SAVE DATA ----------------------
let parties = JSON.parse(localStorage.getItem("parties") || "[]");
let workers = JSON.parse(localStorage.getItem("workers") || "[]");
let records = JSON.parse(localStorage.getItem("records") || "[]");

// -------------------- UPDATE DROPDOWNS ----------------------
function updateDropdowns() {
    let partySelect = document.getElementById("partySelect");
    let workerSelect = document.getElementById("workerSelect");
    let salaryWorker = document.getElementById("salaryWorker");

    partySelect.innerHTML = parties.map(p => `<option>${p}</option>`).join("");
    workerSelect.innerHTML = workers.map(w => `<option>${w.name}</option>`).join("");
    salaryWorker.innerHTML = workerSelect.innerHTML;
}
updateDropdowns();

// -------------------- ADD PARTY ----------------------
function addParty() {
    let p = document.getElementById("newParty").value.trim();
    if (p === "") return alert("Enter a party name.");
    if (!parties.includes(p)) parties.push(p);
    localStorage.setItem("parties", JSON.stringify(parties));
    document.getElementById("newParty").value = "";
    updateDropdowns();
    alert("Party saved!");
}

// -------------------- ADD WORKER ----------------------
function addWorker() {
    let name = document.getElementById("newWorker").value.trim();
    let category = document.getElementById("categorySelect").value;

    if (name === "") return alert("Enter worker name.");

    workers.push({ name, category });
    localStorage.setItem("workers", JSON.stringify(workers));
    document.getElementById("newWorker").value = "";
    updateDropdowns();
    alert("Worker saved!");
}

// -------------------- MARK ATTENDANCE ----------------------
function markAttendance() {
    let record = {
        date: new Date().toLocaleDateString("en-IN"),
        party: document.getElementById("partySelect").value,
        worker: document.getElementById("workerSelect").value,
        status: document.getElementById("statusSelect").value
    };

    records.push(record);
    localStorage.setItem("records", JSON.stringify(records));

    loadTable();
    alert("Attendance marked!");
}

// -------------------- SHOW TABLE ----------------------
function loadTable() {
    let table = document.getElementById("recordTable");
    table.innerHTML = `
        <tr>
            <th>Date</th>
            <th>Party</th>
            <th>Worker</th>
            <th>Status</th>
            <th>Delete</th>
        </tr>`;

    records.forEach((r, i) => {
        table.innerHTML += `
            <tr>
                <td>${r.date}</td>
                <td>${r.party}</td>
                <td>${r.worker}</td>
                <td>${r.status}</td>
                <td><button class="btn-red" onclick="deleteRecord(${i})">X</button></td>
            </tr>`;
    });
}
loadTable();

// -------------------- DELETE RECORD ----------------------
function deleteRecord(i) {
    records.splice(i, 1);
    localStorage.setItem("records", JSON.stringify(records));
    loadTable();
}

// -------------------- CALCULATE SALARY ----------------------
function calculateSalary() {
    let name = document.getElementById("salaryWorker").value;
    let wage = parseFloat(document.getElementById("dailyWage").value);

    if (!wage) return alert("Enter valid wage.");

    let days = 0;
    records.forEach(r => {
        if (r.worker === name) {
            if (r.status === "Present") days += 1;
            else if (r.status === "Half Day") days += 0.5;
        }
    });

    document.getElementById("daysWorked").innerText = days;

    let salary = wage * days;

    document.getElementById("salaryOutput").innerHTML =
        `<b>Total Salary for ${name}: ₹${salary.toFixed(2)}</b>`;
}
</script>

</body>
</html>
